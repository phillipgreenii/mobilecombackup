# BUG-051: XML Parsing DoS Vulnerability - Missing Size Limits

## Status
- **Reported**: 2025-01-14
- **Priority**: critical
- **Severity**: major

## Overview
XML parsing in `pkg/calls/xml_reader.go` and `pkg/sms/xml_reader.go` lacks size limits, potentially allowing denial of service attacks through large or malformed XML files that consume excessive memory.

## Reproduction Steps
1. Create extremely large XML file (multi-GB)
2. Attempt to parse with current XML readers
3. Observe potential memory exhaustion

## Expected Behavior
XML parsing should have reasonable size limits to prevent memory exhaustion attacks.

## Actual Behavior
No size limits on XML parsing could lead to out-of-memory conditions.

## Environment
- All versions
- All platforms

## Root Cause Analysis
### Root Cause
XML parsers don't implement size limits or resource constraints, making them vulnerable to resource exhaustion attacks.

## Fix Approach
Implement size-limited readers for XML parsing to prevent memory exhaustion.

## Tasks
- [ ] Add configurable size limits for XML parsing
- [ ] Implement LimitedReader wrapper for XML decoders
- [ ] Add appropriate error handling for size limit exceeded
- [ ] Write tests for size limit enforcement
- [ ] Document size limits and configuration options

## Testing
### Regression Tests
- Test normal-sized files are processed correctly
- Test oversized files are rejected appropriately
- Test edge cases around size limits

### Verification Steps
1. Create large XML test files
2. Verify size limits are enforced
3. Test error handling for oversized files
4. Verify memory usage remains bounded

## Related Issues
- Files affected: pkg/calls/xml_reader.go, pkg/sms/xml_reader.go
- Source: CODE_IMPROVEMENT_REPORT.md item #3

## Notes
Consider making size limits configurable through command-line flags or configuration file. Default limits should be reasonable for typical mobile backup files.